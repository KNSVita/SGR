{% extends 'base.html' %} 

{% block content %}

<form class="form-upload" method="POST" enctype="multipart/form-data">
    <h3>Novo Ranking</h3>
    <div>
        <label for="nome_disciplina">Nome da Disciplina:</label><br>
        <input type="text" name="nome_disciplina" id="nome_disciplina" required>
    </div>

    <div class="pesos-grid">
        <div>
            <label for="peso_real_trab">Peso Real Trab:</label>
            <input type="number" step="0.1" name="peso_real_trab" id="peso_real_trab" required>
        </div>
        <div>
            <label for="peso_real_av">Peso Real AV:</label>
            <input type="number" step="0.1" name="peso_real_av" id="peso_real_av" required>
        </div>
        <div>
            <label for="peso_orig_av">Nota Máxima AV/AVS:</label>
            <input type="number" step="0.1" name="peso_orig_av" id="peso_orig_av" required>
        </div>
    </div>
    <div>
        <label for="file" class="custom-file-upload">
            <div>
                <i class="fas fa-upload"></i>
                <span>Clique para selecionar a planilha</span>
            </div>
        </label>
        
        <small class="form-help-text">
            Verifica na planilha a coluna Trab, AV e AVS
        </small>
        
        <input type="file" name="file" id="file" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" required>
    </div>
    
    <button type="submit">Enviar e Classificar</button>
</form>

{% if erro %}
<p class="error-message">{{ erro }}</p>
{% endif %}

<h3>Rankings Salvos</h3>
{% if classificacoes %}
<ul class="lista-rankings">
  {% for c in classificacoes %}
  <li>
    <a
      href="{{ url_for('ver_ranking', id_classificacao=c.id) }}"
      class="ranking-link-main"
    >
      <span>{{ c.nome_disciplina }}</span>
      <i class="fas fa-chevron-right"></i>
    </a>

    <form
      method="POST"
      action="{{ url_for('delete_classificacao', id_classificacao=c.id) }}"
      class="form-delete"
    >
      <button
        type="submit"
        class="btn-delete"
        onclick="return confirm('Tem certeza que deseja excluir esta classificação? Todo o ranking será perdido.');"
      >
        <i class="fas fa-trash"></i>
      </button>
    </form>
  </li>
  {% endfor %}
</ul>
{% else %}
<p>Nenhum ranking foi enviado ainda.</p>
{% endif %} 

{% endblock %} 

{% block scripts %}
<script src="{{ url_for('static', filename='script.js') }}"></script>
{% endblock %}